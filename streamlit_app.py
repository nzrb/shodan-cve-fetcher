import streamlit as st
import requests

# Title of the application
st.title('CVE Fetcher')

# User input
user_input = st.text_input('Enter CVE in the format CVE-2024-3400')

# Button to make the request
if st.button('Fetch CVE Data'):
    # Construct the URL with the user input
    url = f'https://cvedb.shodan.io/cve/{user_input}'
    
    # Make the GET request
    response = requests.get(url)
    
    # Check if the request was successful
    if response.status_code == 200:
        # Display the JSON response
        st.json(response.json())
    else:
        st.error('Failed to retrieve data. Status code: ' + str(response.status_code))
